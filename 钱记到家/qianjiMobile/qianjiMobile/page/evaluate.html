<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>发表评价</title>
    <link rel="stylesheet" href="../css/base.css">
    <link rel="stylesheet" href="../css/evaluate.css">
    <script src="../js/jquery-3.4.1.min.js"></script>
</head>

<body>
    <div class="goodsList">
        <div class="goods">
            <div class="goodsImg"><img src="" alt=""></div>
            <div class="goods-right">
                <p class="goodsName">roaringwild ss18 咆哮猛兽 观察原生面料印花短袖roaringwild ss18 咆哮猛兽 观察原生面料印花短袖roaringwild ss18 咆哮猛兽 观察原生面料印花短袖</p>
            </div>
        </div>
        <div class="evaluate line">
            <span>商品评价</span>
            <img class="star" src="../images/star2.png" alt="">
            <img class="star" src="../images/star2.png" alt="">
            <img class="star" src="../images/star2.png" alt="">
            <img class="star" src="../images/star2.png" alt="">
            <img class="star" src="../images/star2.png" alt="">
        </div>
        <img class="write" src="../images/write.png" alt="">
        <textarea name="" id="evaluateContent" cols="32" rows="10" placeholder="从多个角度评价宝宝,可以版主更多想买的人"></textarea>
        <div class="upload-img">
            <img src="../images/camera.png" id="photo" alt="" />
        </div>
        <input type="file" name="file" id="file" style="display: none;" />
        <input type="hidden" id="fileVal">
    </div>

    <button class="submit">发布</button>


    <script>
        $(".star").click(function() {
            $('.star').attr("src", "../images/star2.png");
            for (let i = 0; i < $(this).index(); i++) {
                $('.star').eq(i).attr("src", "../images/star3.png");
            }
        })
        $(function() {
            function chooseImage(fileid, imgid, fileValId) {
                var fileObj = document.getElementById(fileid);
                if (typeof(fileObj) == "undefined" || fileObj.files.length == 0) {
                    console.log('file ' + fileid + ' not exists');
                    return;
                }
                var file = fileObj.files[0];
                var reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = function(e) {
                    var imgResult = e.target.result;
                    var imgObj = document.getElementById(imgid);
                    if (typeof(imgObj) != "undefined") {
                        // imgObj.setAttribute("src", imgResult);
                        const img = `<img src='${imgResult}'/>`;
                        if ($('.upload-img').children().length < 7) {
                            $('#photo').before(img);
                        }
                    }
                    var fileValObj = document.getElementById(fileValId);
                    if (typeof(fileValObj) != "undefined") {
                        fileValObj.setAttribute("value", imgResult);
                    }
                };
            };
            $('#file').on('change', function() {
                chooseImage('file', 'photo', 'fileVal');
            });
        });
        $('#photo').click(function() {
            $('#file').click();
        })
    </script>
</body>

</html>